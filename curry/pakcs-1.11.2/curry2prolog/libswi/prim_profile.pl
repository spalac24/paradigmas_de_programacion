:-module(prim_profile,[prim_getProcessInfos/1,prim_garbageCollectorOn/1,prim_garbageCollectorOff/1,prim_garbageCollect/1,prim_evalTime/4,prim_evalSpace/4]).
:-style_check(-singleton).
:-use_module('../prologbasics').
:-use_module('../basics').
prim_getProcessInfos(_G13):- (getCurrentGCs(_G15)->_G23=['Prelude.(,)'('Profile.GarbageCollections',_G15)];_G23=[]), (getCurrentChoiceSize(_G35)->_G43=['Prelude.(,)'('Profile.Choices',_G35)|_G23];_G43=_G23), (getCurrentHeapSize(_G55)->_G63=['Prelude.(,)'('Profile.Heap',_G55)|_G43];_G63=_G43), (getCurrentStackSize(_G75)->_G83=['Prelude.(,)'('Profile.Stack',_G75)|_G63];_G83=_G63), (getCurrentCodeSize(_G95)->_G103=['Prelude.(,)'('Profile.Code',_G95)|_G83];_G103=_G83), (getCurrentMemorySize(_G115)->_G123=['Prelude.(,)'('Profile.Memory',_G115)|_G103];_G123=_G103), (getElapsedTime(_G135)->_G143=['Prelude.(,)'('Profile.ElapsedTime',_G135)|_G123];_G143=_G123), (getRunTime(_G155)->_G163=['Prelude.(,)'('Profile.RunTime',_G155)|_G143];_G163=_G143),_G13=_G163.
prim_garbageCollectorOn('Prelude.()'):-garbageCollectorOn.
prim_garbageCollectorOff('Prelude.()'):-garbageCollectorOff.
prim_garbageCollect('Prelude.()'):-garbageCollect.
prim_evalTime(_G394,_G395,_G396,_G397):-freeze(_G396,blocked_prim_evalTime(_G394,_G395,_G396,_G397)).
blocked_prim_evalTime(_G7,_G8,_G9,_G10):-garbageCollect,getRunTime(_G12),getElapsedTime(_G14),getCurrentGCs(_G16),user:normalizeAndCheck(_G7,_G8,_G9,_G21),getRunTime(_G26),getElapsedTime(_G28),getCurrentGCs(_G30),writeErr('EVALTIME: Runtime: '),_G37 is _G26-_G12,writeErr(_G37),writeErr(' msec.'),nlErr,writeErr('EVALTIME: Elapsed time: '),_G49 is _G28-_G14,writeErr(_G49),writeErr(' msec.'),nlErr,writeErr('EVALTIME: Number of garbage collections: '),_G61 is _G30-_G16,writeErr(_G61),nlErr,garbageCollectorOn,_G21=_G10.
prim_evalSpace(_G288,_G289,_G290,_G291):-freeze(_G290,blocked_prim_evalSpace(_G288,_G289,_G290,_G291)).
blocked_prim_evalSpace(_G13,_G14,_G15,_G16):-garbageCollect,garbageCollectorOff,getRunTime(_G18),getElapsedTime(_G20),getCurrentGCs(_G22),getCurrentHeapSize(_G24),getCurrentStackSize(_G26),user:normalizeAndCheck(_G13,_G14,_G15,_G31),getRunTime(_G36),getElapsedTime(_G38),getCurrentGCs(_G40),getCurrentHeapSize(_G42),getCurrentStackSize(_G44),writeErr('EVALTIME: Runtime: '),_G51 is _G36-_G18,writeErr(_G51),writeErr(' msec.'),nlErr,writeErr('EVALTIME: Elapsed time: '),_G63 is _G38-_G20,writeErr(_G63),writeErr(' msec.'),nlErr,writeErr('EVALTIME: Number of garbage collections: '),_G75 is _G40-_G22,writeErr(_G75),nlErr,writeErr('EVALTIME: Global stack usage: '),_G85 is _G42-_G24,writeErr(_G85),nlErr,writeErr('EVALTIME: Local stack usage: '),_G95 is _G44-_G26,writeErr(_G95),nlErr,garbageCollectorOn,_G31=_G16.
